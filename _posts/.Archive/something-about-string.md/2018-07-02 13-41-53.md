---
title: 从一条没有被释放的字符串说起
comments: true
---

###栈(Stack)和堆(Heap)
为什么堆栈总是被同时提及，而又傻傻分不清楚？在一般的中英词典中Stack(n. 堆；堆叠)和Heap(n. 堆；许多；累积)，都被翻译成堆，并没有出现栈这个词。而栈在中文词典里是“储存货物或供旅客住宿的房屋”的意思。所以推测译者是为了在中文里区分这两个“堆”而特意找的相近的词——“栈”。

那么在英文里Stack和Heap有什么区别呢？在朗文英语词典中，Stack意思是`a neat pile of things `，它指向了一个近义词Heap，意思是`a large untidy pile of things`。区别在于Stack是整齐地堆叠，Heap是一大物品的堆积，是不是有种恍然大悟的感觉，其实在中文翻译中已经有所体现，“叠”和“积”的差异。

在计算机领域，数据结构和内存概念中都出现了Heap这个词，也很容易混淆。最初Heap是表示的一种树型的数据结构，根据根节点大于还是小于子节点，分为最大堆和最小堆。

更多的情况下，当我们说堆栈时，我们说的是一种内存的分配方式。


> Stacks in computing architectures are regions of memory where data is added or removed in a last-in-first-out  manner.

>   Heap  is a common name for the pool of memory from which dynamically allocated memory is allocated.

![ ]( /assets/_site/img/9c2VH.png )
###weak被设置为nil的时机和原理


###字符串储存在堆上还是栈上


[objective c - Are NSStrings stored on the heap or on the stack and what is a good way to initialize one - Stack Overflow](https://stackoverflow.com/questions/7376261/are-nsstrings-stored-on-the-heap-or-on-the-stack-and-what-is-a-good-way-to-initi)

[iphone - Why do weak NSString properties not get released in iOS? - Stack Overflow](https://stackoverflow.com/questions/11107729/why-do-weak-nsstring-properties-not-get-released-in-ios)

[objective c - Why isn’t my weak reference cleared right after the strong ones are gone? - Stack Overflow](https://stackoverflow.com/questions/15266367/why-isn-t-my-weak-reference-cleared-right-after-the-strong-ones-are-gone)

[iOS中，对象释放机制以及__weak、__unsafe_unretained的一些问题 - Rain技术支持 - 开源中国](https://my.oschina.net/rainwz/blog/1835660)

###为什么字符串要用copy修饰

###为什么C不再是适合现代的语言

###CPU虚拟内存的堆栈

[c - How to find whether a given address is in heap or in stack - Stack Overflow](https://stackoverflow.com/questions/33798216/how-to-find-whether-a-given-address-is-in-heap-or-in-stack)

[memory management - What and where are the stack and heap? - Stack Overflow](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap)

[将stack翻译成"堆栈"实在是误人子弟 - veli - 博客园](https://www.cnblogs.com/idorax/p/6277906.html)
